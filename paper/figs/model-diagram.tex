% Tikz shape definitions
\tikzstyle{parentbox} = [rectangle, rounded corners=1mm] % TODO
\tikzstyle{nnbox} = [parentbox, minimum width=35mm, minimum height=10mm, text centered, draw=customteal, fill=customteal!30, text=fontcolor]
\tikzstyle{transformerbox} = [parentbox, minimum width=35mm, minimum height=10mm, text centered, draw=customgreen, fill=customgreen!30, text=fontcolor]
\tikzstyle{xgbbox} = [parentbox, minimum width=35mm, minimum height=10mm, text centered, draw=customorange, fill=customorange!30, text=fontcolor]
\tikzstyle{pcabox} = [parentbox, minimum width=20mm, minimum height=7mm, text centered, draw=customorange!70, fill=customorange!10, text=fontcolor!70]
\tikzstyle{databox} = [parentbox, minimum width=40mm, minimum height=12mm, text centered, draw=red!70, fill=red!10, text=fontcolor!70]
\tikzstyle{convnode} = [rectangle, rounded corners=3mm, minimum width=6mm, minimum height=6mm, fill=customteal!40, draw=customteal!80]
\tikzstyle{output} = [parentbox, minimum width=30mm, minimum height=10mm, fill=blue!20, draw=blue!50]

% Arrows
\tikzstyle{parentarrow} = [-stealth, line width=0.5mm]
\tikzstyle{sarrowxgb} = [parentarrow, draw=customorange!70]
\tikzstyle{sarrownn} = [parentarrow, draw=customteal!70]
\tikzstyle{sarrowtr} = [parentarrow, draw=customgreen!70]
\tikzstyle{sarrowout} = [parentarrow, draw=blue!50]


\begin{tikzpicture}

% Data
\node (bioclim) [databox] {Bioclimatic Rasters};
\node (landsat) [databox, below of=bioclim, yshift=-7mm] {LandSat};
\node (metadata) [databox, below of=landsat, yshift=-7mm] {Metadata};
\node (sentinel) [databox, below of=metadata, yshift=-7mm] {Sentinel};

% PCAs
\node (pca0) [pcabox, right of=bioclim, xshift=30mm, yshift=30mm] {PCA$_0$}; 
\node (pca1) [pcabox, below of=pca0] {PCA$_1$}; 
\node (vertellipsis0) [below of=pca1, yshift=3mm] {\Large{\textcolor{fontcolor!70}{$\cdot$}}};
\node (vertellipsis1) [below of=vertellipsis0, yshift=9mm] {\Large{\textcolor{fontcolor!70}{$\cdot$}}};
\node (vertellipsis2) [below of=vertellipsis1, yshift=9mm] {\Large{\textcolor{fontcolor!70}{$\cdot$}}};
\node (pca2) [pcabox, below of=vertellipsis2, yshift=3mm] {PCA$_n$}; 
\draw[sarrowxgb] (bioclim.east) .. controls +(right:5mm) and +(left:8mm) .. (pca0.west);
\draw[sarrowxgb] (bioclim.east) .. controls +(right:5mm) and +(left:8mm) .. (pca1.west);
\draw[sarrowxgb] (bioclim.east) .. controls +(right:5mm) and +(left:8mm) .. (pca2.west);

% XGB
\node (xgb) [xgbbox, right of=pca0, xshift=30mm, yshift=-15mm] {XGBoostRegressor};
\draw[sarrowxgb] (pca0.east) .. controls +(right:5mm) and +(left:8mm) .. (xgb.west);
\draw[sarrowxgb] (pca1.east) .. controls +(right:5mm) and +(left:8mm) .. (xgb.west);
\draw[sarrowxgb] (pca2.east) .. controls +(right:5mm) and +(left:8mm) .. (xgb.west);
\draw[sarrowxgb] (landsat.east) .. controls +(right:35mm) and +(left:10mm) .. (xgb.west);
\draw[sarrowxgb] (metadata.east) .. controls +(right:35mm) and +(left:10mm) .. (xgb.west);

% ResNet
\node (nn0) [nnbox, below of=xgb, yshift=-15mm] {ResNet18};
\node (nn1) [nnbox, below of=nn0, yshift=-3mm] {ResNet18};
\node (nn2) [nnbox, below of=nn1, yshift=-3mm] {ResNet18};
\node (conv) [convnode, right of=nn1, xshift=20mm] {};
\draw[sarrownn] (bioclim.east) .. controls +(right:25mm) and +(left:20mm) .. (nn0.west);
\draw[sarrownn] (landsat.east) .. controls +(right:25mm) and +(left:20mm) .. (nn1.west);
\draw[sarrownn] (sentinel.east) .. controls +(right:25mm) and +(left:20mm) .. (nn2.west);
\draw[sarrownn] (nn0.east) .. controls +(right:7mm) and +(left:7mm) .. (conv.west);
\draw[sarrownn] (nn1.east) .. controls +(right:7mm) and +(left:7mm) .. (conv.west);
\draw[sarrownn] (nn2.east) .. controls +(right:7mm) and +(left:7mm) .. (conv.west);

% Transformer
\node (transformer) [transformerbox, below of=nn2, yshift=-15mm] {Transformer};
\draw[sarrowtr] (bioclim.east) .. controls +(right:25mm) and +(left:20mm) .. (transformer.west);
\draw[sarrowtr] (landsat.east) .. controls +(right:25mm) and +(left:20mm) .. (transformer.west);
\draw[sarrowtr] (metadata.east) .. controls +(right:25mm) and +(left:20mm) .. (transformer.west);
\draw[sarrowtr] (sentinel.east) .. controls +(right:25mm) and +(left:20mm) .. (transformer.west);

% Output
\node (output) [output, right of=transformer, xshift=30mm, yshift=-15mm] {Output};
\draw[sarrowout] (xgb.east) .. controls +(right:25mm) and +(north:50mm) .. (output.north);
\draw[sarrowout] (conv.east) .. controls +(right:5mm) and +(north:20mm) .. (output.north);
\draw[sarrowout] (transformer.east) .. controls +(right:15mm) and +(north:10mm) .. (output.north);

\end{tikzpicture} 